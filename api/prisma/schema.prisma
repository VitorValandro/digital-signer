generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id              String           @id @unique @default(uuid())
  name            String
  email           String           @unique
  password        String
  documents       Document[]
  signatures      Signature[]
  signatureAssets SignatureAsset[]
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model Document {
  id                String      @id @unique @default(uuid())
  originalFilePath  String
  signedFilePath    String      @unique
  blankDocumentUrl  String
  signedDocumentUrl String?
  signatures        Signature[]
  User              User?       @relation(fields: [userId], references: [id])
  userId            String?
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
}

model Signature {
  id               String          @id @unique @default(uuid())
  isSigned         Boolean         @default(false)
  x                Float?
  y                Float?
  width            Float?
  height           Float?
  pageIndex        Int?
  document         Document        @relation(fields: [documentId], references: [id])
  documentId       String
  signee           User?           @relation(fields: [signeeId], references: [id])
  signeeId         String?
  signatureAsset   SignatureAsset? @relation(fields: [signatureAssetId], references: [id])
  signatureAssetId String?
  signedAt         DateTime        @default(now())
}

model SignatureAsset {
  id           String      @id @default(uuid())
  signatureUrl String
  signee       User        @relation(fields: [signeeId], references: [id])
  signeeId     String
  signatures   Signature[]
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
}
